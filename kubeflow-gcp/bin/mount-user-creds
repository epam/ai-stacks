#!/bin/sh -e
kubectl="kubectl -n $NAMESPACE"
GOOGLE_SECRET_NAME="${GOOGLE_SECRET_NAME:-gcp-credentials}"

if $kubectl get secret "$GOOGLE_SECRET_NAME" > /dev/null 2>&1; then
    echo "Secret $GOOGLE_SECRET_NAME already exists"
else
    $kubectl create secret generic "GOOGLE_SECRET_NAME" \
        --from-file="credentials.json=$HOME/.config/gcloud/application_default_credentials.json"
fi
